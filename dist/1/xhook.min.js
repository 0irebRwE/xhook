// XHook - v1.0.0 - https://github.com/jpillora/xhook
// Jaime Pillora <dev@jpillora.com> - MIT Copyright 2013
!function(a){var b,c,d,e,f,g,h,i,j=[].slice;d="xhook",c="readyState",b=function(a){var b,c;return c={},b={stats:stats,on:function(a,b,d){c[a]||(c[a]=[]),c[a].splice(d||c[a].length,0,b)},off:function(a){var b,d,e,f,g,h;if(c[a]){for(e=-1,h=c[a],d=f=0,g=h.length;g>f;d=++f)b=h[d],b===fn&&(e=d);-1!==e&&c[a].splice(e,1)}},each:function(a,b){var d,e,f,g;if(c[a])for(stats[a]=stats[a]+1||1,g=c[a],e=0,f=g.length;f>e;e++)d=g[e],b(d)},fire:function(){var c,d;d=arguments[0],c=2<=arguments.length?j.call(arguments,1):[],b.each(d,function(b){return b.apply(a,c)})}}},h=b(),i=function(a,b){return h.on(d,a,b)},e=function(a,b){var c,d,e,f,g,h;switch(null==b&&(b={}),typeof a){case"object":d=[];for(e in a)f=a[e],d.push(""+e+":	"+f);return d.join("\n");case"string":for(d=a.split("\n"),g=0,h=d.length;h>g;g++)c=d[g],/([^:]+):\s*(.+)/.test(c)&&(b[RegExp.$1]||(b[RegExp.$1]=RegExp.$2));return b}},i.headers=e,i.PROPS=PROPS,f=function(b){var c;return(c=a[b])?a[b]=function(a){return"string"!=typeof a||/\.XMLHTTP/.test(a)?g(new c(a)):void 0}:void 0},f("ActiveXObject"),f("XMLHttpRequest"),g=function(a){var f,g,i,j,k,l,m,n,o;return i=[],m=0,j={headers:{}},k={headers:{}},o=b(),n={request:j,response:k},n.serialize=function(){return{request:j,response:k}},n.deserialize=function(a){return j=a.request,k=a.response},l=function(a){return g[c]=a,o.fire("readystatechange")},f=function(b){var c,d,e;c={};for(d in b)e=b[d],c[d]=e===a?g:e;return c},a.onreadystatechange=function(b){var d,g,h;if(i.push(f(b)),2===a[c]){k.status=a.status,k.statusText=a.statusText,h=e(a.getAllResponseHeaders());for(d in h)g=h[d],k.headers[d]||(k.headers[d]=g)}return 4===a[c]?(k.resp=a.response,k.body=a.responseText,k.xml=a.responseXML):void 0},g={withCredentials:!1},g.addEventListener=o.on,g.removeEventListener=o.off,g.dispatchEvent=function(){},g.open=function(a,b,c){j.method=a,j.url=b,j.async=c,m=1},g.send=function(b){var c;j.body=b,c=function(){return a.open(j.method,j.url,j.async),a.send(j.body),m=4},n.beforeSend?n.beforeSend(c):c()},g.abort=function(){},g.setRequestHeader=function(a,b){return j.headers[a]=b},g.getResponseHeader=function(a){return k.headers[a]},g.getAllResponseHeaders=function(){return e(k.headers)},g.overrideMimeType=function(){},g.upload={},h.fire(d,n),g},a[d]=i}(window,document);